/* Accordion (Sections With Show/Hide Functionality) - Author: SÃ©bastien Millart - Version: 1.0.x - Licence: https://github.com/smillart/WAI-ARIA-Patterns-And-Widgets/blob/master/LICENSE */
window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var i=0;i<this.length;i++)t.call(e,this[i],i,this)});class ControllerManager{constructor(t,e){this.currentItem=t,this.items=e,this.keyCode=Object.freeze({RETURN:13,SPACE:32,END:35,HOME:36,UP:38,DOWN:40})}setFocusToFirstItem(){this.items[0].domNode.focus()}setFocusToLastItem(){this.items[this.items.length-1].domNode.focus()}setFocusToPreviousItem(){var t;this.currentItem===this.items[0]?this.setFocusToLastItem():(t=this.items.indexOf(this.currentItem),this.items[t-1].domNode.focus())}setFocusToNextItem(){var t;this.currentItem===this.items[this.items.length-1]?this.setFocusToFirstItem():(t=this.items.indexOf(this.currentItem),this.items[t+1].domNode.focus())}}class AccordionController extends ControllerManager{constructor(t,e){super(t,e.buttons),this.trigger=this.currentItem.domNode,this.accordion=e,this.bindEvents()}bindEvents(){this.trigger.addEventListener("click",this.handleClick.bind(this)),this.trigger.addEventListener("keydown",this.handleKeydown.bind(this))}handleClick(t){this.togglePanel()}handleKeydown(t){console.log("[keydown]");var e=!1;switch(t.keyCode){case this.keyCode.UP:this.setFocusToPreviousItem(),e=!0;break;case this.keyCode.DOWN:this.setFocusToNextItem(),e=!0;break;case this.keyCode.HOME:this.setFocusToFirstItem(),e=!0;break;case this.keyCode.END:this.setFocusToLastItem(),e=!0}e&&(t.stopPropagation(),t.preventDefault())}togglePanel(){if(this.trigger.hasAttribute("aria-expanded")){var t="true"==this.trigger.getAttribute("aria-expanded"),e=!1;this.items.forEach((function(t,i){"true"===t.domNode.getAttribute("aria-expanded")&&(e=t.domNode)}),this),!this.accordion.allowMultiple&&e&&e!==this.trigger&&(e.setAttribute("aria-expanded","false"),document.getElementById(e.getAttribute("aria-controls")).setAttribute("hidden",""),this.accordion.allowToggle||e.removeAttribute("aria-disabled")),t?this.accordion.allowToggle&&t&&(this.trigger.setAttribute("aria-expanded","false"),document.getElementById(this.trigger.getAttribute("aria-controls")).setAttribute("hidden","")):(this.trigger.setAttribute("aria-expanded","true"),document.getElementById(this.trigger.getAttribute("aria-controls")).removeAttribute("hidden"),this.accordion.allowToggle||this.trigger.setAttribute("aria-disabled","true"))}else this.items.indexOf(this.currentItem)===this.accordion.getOpenDefault()?(this.trigger.setAttribute("aria-expanded","true"),this.accordion.allowToggle||this.trigger.setAttribute("aria-disabled","true")):(this.trigger.setAttribute("aria-expanded","false"),document.getElementById(this.trigger.getAttribute("aria-controls")).setAttribute("hidden",""))}}class WidgetManager{constructor(t,e){this.domNode=t,this.nodeClass="aria-"+e}hasSetting(t,e=!0){var i=this.domNode.hasAttribute(`data-${this.nodeClass}-${t}`);return i&&(this.domNode.removeAttribute(`data-${this.nodeClass}-${t}`),e&&this.addClass(this.domNode,`${this.nodeClass}--${t}`,!1)),i}getSetting(t,e=!0){if(this.domNode.hasAttribute(`data-${this.nodeClass}-${t}`)){var i=this.domNode.getAttribute(`data-${this.nodeClass}-${t}`);return this.domNode.removeAttribute(`data-${this.nodeClass}-${t}`),e&&"none"!==i&&this.addClass(this.domNode,`${this.nodeClass}--${t}`,!1),i}}addClass(t,e,i=!0){if("string"==typeof e){var s="data-"+e.replace(/__|--/g,"-");t&&(t.classList.add(e),t.hasAttribute(s)&&i&&t.removeAttribute(s))}}}class Button{constructor(t,e=!1){this.textNode=t,this.targetID=e,this.domNode,this.init()}init(){this.domNode=document.createElement("button"),this.domNode.setAttribute("type","button"),this.textNode&&this.domNode.appendChild(document.createTextNode(this.textNode)),this.targetID&&document.getElementById(this.targetID)&&(this.domNode.setAttribute("aria-controls",this.targetID),this.domNode.setAttribute("id",this.targetID+"-trigger"))}}class Accordion extends WidgetManager{constructor(t,e){var i="Accordion constructor argument domNode",s="H2-H6 [data-aria-accordion-heading]",o="DIV [data-aria-accordion-panel]";if(!t instanceof Element)throw new TypeError(i+"is not a DOM Element.");if(0===t.childElementCount)throw new Error(i+" has no element children.");for(var a=new RegExp("H2|H3|H4|H5|H6","gi"),n=t.firstElementChild;n;){if(n&&"LI"===n.tagName)for(var d=n.firstElementChild;d;){if(d&&(!d.tagName.match(a)||!d.hasAttribute("data-aria-accordion-heading"))&&("DIV"!==d.tagName||!d.hasAttribute("data-aria-accordion-panel")))throw new Error(`${i} has UL/OL descendant elements that do not match with ${s} or ${o} as required.`);d=d.nextElementSibling}else if(n&&(!n.tagName.match(a)||!n.hasAttribute("data-aria-accordion-heading"))&&("DIV"!==n.tagName||!n.hasAttribute("data-aria-accordion-panel")))throw new Error(`${i} has direct descendant elements that do not match with ${s} or ${o} as required.`);n=n.nextElementSibling}super(t,"accordion"),this.accordionHeadingClass=this.nodeClass+"__heading",this.accordionPanelClass=this.nodeClass+"__panel",this.accordionHeading="[data-aria-accordion-heading]",this.accordionPanel="[data-aria-accordion-panel]",this.buttons=[],this.headings,this.panels,this.customClass,this.openDefault,this.panelTransition,this.allowMultiple,this.allowToggle,this.idCounter=0,this.index=e,this.init()}init(){this.idCounter+=1,this.domNode.hasAttribute("id")||this.domNode.setAttribute("id",`acc-${this.idCounter}-${this.index}`),this.addClass(this.domNode,this.nodeClass),document.querySelectorAll(`#${this.domNode.id} > li`).length?(this.headings=document.querySelectorAll(`#${this.domNode.id} > li > ${this.accordionHeading}`),this.panels=document.querySelectorAll(`#${this.domNode.id} > li > ${this.accordionPanel}`)):(this.headings=document.querySelectorAll(`#${this.domNode.id} > ${this.accordionHeading}`),this.panels=document.querySelectorAll(`#${this.domNode.id} > ${this.accordionPanel}`)),this.customClass=this.getSetting("custom-class",!1),this.customClass&&this.addClass(this.domNode,`${this.nodeClass}--${this.customClass}`),this.openDefault=this.getSetting("open-default"),this.allowMultiple=this.hasSetting("allow-multiple"),this.allowToggle=this.allowMultiple?this.allowMultiple:this.hasSetting("allow-toggle"),this.panelTransition=this.hasSetting("panel-transition",!1),this.setupPanels(),this.setupHeadingButton()}setupPanels(){this.panels.forEach((function(t,e){this.addClass(t,this.accordionPanelClass),t.setAttribute("id",`${this.domNode.id}-panel-${e+1}`),this.panelTransition&&this.addClass(t,this.accordionPanelClass+"--transition",!1)}),this)}setupHeadingButton(){this.headings.forEach((function(t,e){this.addClass(t,this.accordionHeadingClass);var i=new Button(t.textContent,t.nextElementSibling.id);this.buttons.push(i),t.innerHTML="",t.appendChild(i.domNode),(this.allowMultiple&&this.panels.length<7||!this.allowMultiple)&&i.domNode.hasAttribute("aria-controls")&&(document.getElementById(i.domNode.getAttribute("aria-controls")).setAttribute("role","region"),document.getElementById(i.domNode.getAttribute("aria-controls")).setAttribute("aria-labelledby",i.domNode.id)),new AccordionController(i,this).togglePanel()}),this)}getOpenDefault(){return void 0!==this.openDefault&&"none"!==this.openDefault&&NaN!==parseInt(this.openDefault)?this.openDefault<=1?0:this.openDefault-1>=this.panels.length?this.panels.length-1:this.openDefault-1:!this.allowToggle&&"none"!==this.openDefault&&0}}window.addEventListener("DOMContentLoaded",(function(t){document.querySelectorAll("[data-aria-accordion]").forEach((function(t,e){new Accordion(t,e)}))}));